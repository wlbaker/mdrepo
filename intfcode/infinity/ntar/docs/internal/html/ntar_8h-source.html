<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Network Trace And Retrieval (NTAR) library: ntar.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<h1>ntar.h</h1><a href="ntar_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * Copyright (c) 2005, Condor Engineering, Inc. </span>
00003 <span class="comment"> * All rights reserved.</span>
00004 <span class="comment"> * </span>
00005 <span class="comment"> * Redistribution and use in source and binary forms, with or without </span>
00006 <span class="comment"> * modification, are permitted provided that the following conditions </span>
00007 <span class="comment"> * are met:</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * 1. Redistributions of source code must retain the above copyright </span>
00010 <span class="comment"> * notice, this list of conditions and the following disclaimer.</span>
00011 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright </span>
00012 <span class="comment"> * notice, this list of conditions and the following disclaimer in the </span>
00013 <span class="comment"> * documentation and/or other materials provided with the distribution. </span>
00014 <span class="comment"> * 3. Neither the name of the Company (Condor Engineering, Inc) nor the</span>
00015 <span class="comment"> * names of its contributors may be used to endorse or promote products </span>
00016 <span class="comment"> * derived from this software without specific prior written permission. </span>
00017 <span class="comment"> * </span>
00018 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS </span>
00019 <span class="comment"> * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT </span>
00020 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR </span>
00021 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT </span>
00022 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, </span>
00023 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT </span>
00024 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, </span>
00025 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY </span>
00026 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT </span>
00027 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE </span>
00028 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00029 <span class="comment"> * </span>
00030 <span class="comment"> */</span>
00031 
00032 <span class="comment">/*</span>
00033 <span class="comment"> * Author: Gianluca Varenni &lt;gianluca.varenni@gmail.com&gt;</span>
00034 <span class="comment"> */</span>
00035 
00036 <span class="preprocessor">#ifndef __NTAR_09443049285795464587845827</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#define __NTAR_09443049285795464587845827</span>
00038 <span class="preprocessor"></span>
00039 
00045 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00046 <span class="preprocessor">#include "block_headers.h"</span>
00047 
00048 <span class="preprocessor">#ifdef __cplusplus</span>
00049 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00050 <span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>
<a name="l00102"></a><a class="code" href="group__ExportedErrorCodes.html#ga0">00102</a> <span class="preprocessor">#define NTAR_SUCCESS                    0   </span>
<a name="l00103"></a><a class="code" href="group__ExportedErrorCodes.html#ga1">00103</a> <span class="preprocessor">#define NTAR_FAILURE                    1   </span>
<a name="l00104"></a><a class="code" href="group__ExportedErrorCodes.html#ga2">00104</a> <span class="preprocessor">#define NTAR_FAILURE_INVALID_ID         2   </span>
<a name="l00105"></a><a class="code" href="group__ExportedErrorCodes.html#ga3">00105</a> <span class="preprocessor">#define NTAR_FAILURE_FILENOTFOUND       3   </span>
<a name="l00106"></a><a class="code" href="group__ExportedErrorCodes.html#ga4">00106</a> <span class="preprocessor">#define NTAR_FAILURE_FILEEXISTS         4   </span>
<a name="l00107"></a><a class="code" href="group__ExportedErrorCodes.html#ga5">00107</a> <span class="preprocessor">#define NTAR_FAILURE_CREATEFILEFAILED   5   </span>
<a name="l00108"></a><a class="code" href="group__ExportedErrorCodes.html#ga6">00108</a> <span class="preprocessor">#define NTAR_FAILURE_NOMEM              6   </span>
<a name="l00109"></a><a class="code" href="group__ExportedErrorCodes.html#ga7">00109</a> <span class="preprocessor">#define NTAR_FAILURE_SECTIONNOTCLOSED   7   </span>
<a name="l00110"></a><a class="code" href="group__ExportedErrorCodes.html#ga8">00110</a> <span class="preprocessor">#define NTAR_FAILURE_WRITEONREADFILE    8   </span>
<a name="l00111"></a><a class="code" href="group__ExportedErrorCodes.html#ga9">00111</a> <span class="preprocessor">#define NTAR_FAILURE_IOWRITE            9   </span>
<a name="l00112"></a><a class="code" href="group__ExportedErrorCodes.html#ga10">00112</a> <span class="preprocessor">#define NTAR_FAILURE_BLOCKNOTCLOSED     10  </span>
<a name="l00113"></a><a class="code" href="group__ExportedErrorCodes.html#ga11">00113</a> <span class="preprocessor">#define NTAR_FAILURE_IOREAD             11  </span>
<a name="l00114"></a><a class="code" href="group__ExportedErrorCodes.html#ga12">00114</a> <span class="preprocessor">#define NTAR_FAILURE_EOF                12  </span>
<a name="l00115"></a><a class="code" href="group__ExportedErrorCodes.html#ga13">00115</a> <span class="preprocessor">#define NTAR_FAILURE_INVALIDFILE        13  </span>
<a name="l00116"></a><a class="code" href="group__ExportedErrorCodes.html#ga14">00116</a> <span class="preprocessor">#define NTAR_FAILURE_MALFORMED_BLOCK    14  </span>
<a name="l00117"></a><a class="code" href="group__ExportedErrorCodes.html#ga15">00117</a> <span class="preprocessor">#define NTAR_FAILURE_NOMOREBLOCKS       15  </span>
<a name="l00118"></a><a class="code" href="group__ExportedErrorCodes.html#ga16">00118</a> <span class="preprocessor">#define NTAR_FAILURE_BLOCKDATAUNREAD    16  </span>
<a name="l00119"></a><a class="code" href="group__ExportedErrorCodes.html#ga17">00119</a> <span class="preprocessor">#define NTAR_FAILURE_SMALLBUFFER        17  </span>
<a name="l00120"></a><a class="code" href="group__ExportedErrorCodes.html#ga18">00120</a> <span class="preprocessor">#define NTAR_FAILURE_BLOCKDATANOTSET    18  </span>
<a name="l00121"></a><a class="code" href="group__ExportedErrorCodes.html#ga19">00121</a> <span class="preprocessor">#define NTAR_FAILURE_DUPPTR             19  </span>
<a name="l00122"></a><a class="code" href="group__ExportedErrorCodes.html#ga20">00122</a> <span class="preprocessor">#define NTAR_FAILURE_ASCIIDLFILE        20  </span>
<a name="l00123"></a><a class="code" href="group__ExportedErrorCodes.html#ga21">00123</a> <span class="preprocessor">#define NTAR_FAILURE_BLOCKTRAILERMISMATCH 21    </span>
<a name="l00124"></a><a class="code" href="group__ExportedErrorCodes.html#ga22">00124</a> <span class="preprocessor">#define NTAR_FAILURE_ACCESSDENIED       22  </span>
<a name="l00125"></a><a class="code" href="group__ExportedErrorCodes.html#ga23">00125</a> <span class="preprocessor">#define NTAR_FAILURE_BADFILEDESCRIPTOR  23  </span>
<a name="l00126"></a><a class="code" href="group__ExportedErrorCodes.html#ga24">00126</a> <span class="preprocessor">#define NTAR_FAILURE_INVALIDPARAMETER   24  </span>
<a name="l00127"></a><a class="code" href="group__ExportedErrorCodes.html#ga25">00127</a> <span class="preprocessor">#define NTAR_FAILURE_TOOMANYOPENFILES   25  </span>
<a name="l00128"></a><a class="code" href="group__ExportedErrorCodes.html#ga26">00128</a> <span class="preprocessor">#define NTAR_FAILURE_DISKFULL           26  </span>
<a name="l00129"></a><a class="code" href="group__ExportedErrorCodes.html#ga27">00129</a> <span class="preprocessor">#define NTAR_FAILURE_UNKNOWNERRNO       27  </span>
00130 <span class="preprocessor"></span>
<a name="l00138"></a><a class="code" href="group__ExportedDefs.html#ga0">00138</a> <span class="preprocessor">#define NTAR_FILEMODE_WRITE             0   </span>
<a name="l00139"></a><a class="code" href="group__ExportedDefs.html#ga1">00139</a> <span class="preprocessor">#define NTAR_FILEMODE_READ              1   </span>
<a name="l00140"></a><a class="code" href="group__ExportedDefs.html#ga2">00140</a> <span class="preprocessor">#define NTAR_FILEMODE_CREATE            2   </span>
<a name="l00141"></a><a class="code" href="group__ExportedDefs.html#ga3">00141</a> <span class="preprocessor">#define NTAR_FILEMODE_APPEND            3   </span>
00142 <span class="preprocessor"></span>
<a name="l00143"></a><a class="code" href="group__ExportedDefs.html#ga4">00143</a> <span class="preprocessor"></span><span class="preprocessor">#define NTAR_OPEN_WRITE         "w"         </span>
<a name="l00144"></a><a class="code" href="group__ExportedDefs.html#ga5">00144</a> <span class="preprocessor">#define NTAR_OPEN_READ          "r"         </span>
<a name="l00145"></a><a class="code" href="group__ExportedDefs.html#ga6">00145</a> <span class="preprocessor">#define NTAR_OPEN_CREATE        "c"         </span>
<a name="l00146"></a><a class="code" href="group__ExportedDefs.html#ga7">00146</a> <span class="preprocessor">#define NTAR_OPEN_APPEND        "a"         </span>
00147 <span class="preprocessor"></span>
00148 <span class="preprocessor"></span>
<a name="l00159"></a><a class="code" href="struct__ntar__option.html">00159</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ntar__option.html">_ntar_option</a>
00160 {
<a name="l00161"></a><a class="code" href="struct__ntar__option.html#o0">00161</a>     <span class="keyword">struct </span><a class="code" href="struct__ntar__option.html">_ntar_option</a> *<a class="code" href="struct__ntar__option.html#o0">next</a>;          
<a name="l00162"></a><a class="code" href="struct__ntar__option.html#o1">00162</a>     <a class="code" href="bittypes_8h.html#a13">u_int16</a> <a class="code" href="struct__ntar__option.html#o1">code</a>;                       
<a name="l00163"></a><a class="code" href="struct__ntar__option.html#o2">00163</a>     <span class="keywordtype">void</span> *<a class="code" href="struct__ntar__option.html#o2">data</a>;                         
00164 }
00165     <a class="code" href="struct__ntar__option.html">ntar_option</a>;
00166 
<a name="l00170"></a><a class="code" href="group__ExportedStructs.html#ga1">00170</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ntar__block__handle.html">_ntar_block_handle</a> <a class="code" href="group__ExportedStructs.html#ga1">ntar_block_handle</a>;
00171 
<a name="l00177"></a><a class="code" href="group__ExportedStructs.html#ga2">00177</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ntar__section__handle.html">_ntar_section_handle</a> <a class="code" href="group__ExportedStructs.html#ga2">ntar_section_handle</a>;
00178 
<a name="l00182"></a><a class="code" href="group__ExportedStructs.html#ga3">00182</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ntar__file__handle.html">_ntar_file_handle</a> <a class="code" href="group__ExportedStructs.html#ga3">ntar_file_handle</a>;
00183 
<a name="l00203"></a><a class="code" href="group__ExportedStructs.html#ga4">00203</a> <span class="keyword">typedef</span> int (*ntar_write_handler)(<span class="keywordtype">void</span> *handle, <span class="keywordtype">void</span>* buffer, size_t size);
00204 
<a name="l00228"></a><a class="code" href="group__ExportedStructs.html#ga5">00228</a> <span class="keyword">typedef</span> int (*ntar_read_handler)(<span class="keywordtype">void</span> *handle, <span class="keywordtype">void</span>* buffer, size_t size, size_t *read_bytes);
00229 
<a name="l00261"></a><a class="code" href="group__ExportedStructs.html#ga6">00261</a> <span class="keyword">typedef</span> int (*ntar_seek_handler)(<span class="keywordtype">void</span> *handle, <a class="code" href="bittypes_8h.html#a19">ntar_foff</a> new_position, <span class="keywordtype">int</span> origin, <a class="code" href="bittypes_8h.html#a19">ntar_foff</a> *pold_position);
00262 
<a name="l00270"></a><a class="code" href="struct__ntar__file__handlers.html">00270</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ntar__file__handlers.html">_ntar_file_handlers</a>
00271 {
<a name="l00272"></a><a class="code" href="struct__ntar__file__handlers.html#o0">00272</a>     <a class="code" href="group__ExportedStructs.html#ga5">ntar_read_handler</a> <a class="code" href="struct__ntar__file__handlers.html#o0">read_handler</a>;     
<a name="l00273"></a><a class="code" href="struct__ntar__file__handlers.html#o1">00273</a>     <a class="code" href="group__ExportedStructs.html#ga4">ntar_write_handler</a> <a class="code" href="struct__ntar__file__handlers.html#o1">write_handler</a>;   
00274 
<a name="l00280"></a><a class="code" href="struct__ntar__file__handlers.html#o2">00280</a>     <a class="code" href="group__ExportedStructs.html#ga6">ntar_seek_handler</a> <a class="code" href="struct__ntar__file__handlers.html#o2">seek_handler</a>;     
00281 
<a name="l00288"></a><a class="code" href="struct__ntar__file__handlers.html#o3">00288</a>     <span class="keywordtype">void</span> *handle;
00289 }
00290     <a class="code" href="struct__ntar__file__handlers.html">ntar_file_handlers</a>;
00291 
00300 <span class="comment">/* NOTE: we include the plugins only here because the plugins need </span>
00301 <span class="comment">         the definitions of all the ntar structures. If we include</span>
00302 <span class="comment">         the header at the beginning of the file, the definition of</span>
00303 <span class="comment">         _NTAR_H_xxxxxx will be already there, but the structures will</span>
00304 <span class="comment">         not be declared, yet.</span>
00305 <span class="comment">*/</span>
00306 <span class="preprocessor">#include "plugins.h"</span>
00307     
00322 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga0">ntar_open</a>(<span class="keywordtype">char</span>* filename, <span class="keywordtype">char</span>* flags, ntar_file_handle** pfile_handle);
00323 
00344 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga1">ntar_open_by_handlers</a>(<a class="code" href="struct__ntar__file__handlers.html">ntar_file_handlers</a> file_handlers, <span class="keywordtype">char</span>* flags, ntar_file_handle** pfile_handle);
00345 
00354 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga2">ntar_close</a>(ntar_file_handle* file_handle);
00355 
00366 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga3">ntar_create_section</a>(ntar_file_handle* file_handle, ntar_section_handle** psection_handle);
00367 
00376 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga4">ntar_close_section</a>(ntar_section_handle* section_handle);
00377 
00394 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga5">ntar_add_section_option</a>(ntar_section_handle* section_handle, <a class="code" href="struct__ntar__option.html">ntar_option</a> *option);
00395 
00410 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga6">ntar_create_block</a>(ntar_section_handle* section_handle, u_int32 block_type, <span class="keywordtype">void</span> *data, ntar_block_handle** pblock_handle);
00411 
00419 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga7">ntar_close_block</a>(ntar_block_handle* block_handle);
00420 
00434 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga8">ntar_add_block_option</a>(ntar_block_handle* block_handle, <a class="code" href="struct__ntar__option.html">ntar_option</a> *option);
00435 
00447 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga9">ntar_get_next_section</a>(ntar_file_handle* file_handle, ntar_section_handle** psection_handle);
00448 
00461 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga10">ntar_get_previous_section</a>(ntar_file_handle* file_handle, ntar_section_handle** psection_handle);
00462 
00475 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga11">ntar_get_section_options</a>(ntar_section_handle* section_handle, <a class="code" href="struct__ntar__option.html">ntar_option</a> **options);
00476 
00488 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga12">ntar_get_next_block</a>(ntar_section_handle* section_handle, ntar_block_handle** pblock_handle);
00489 
00501 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga13">ntar_get_previous_block</a>(ntar_section_handle* section_handle, ntar_block_handle** pblock_handle);
00502 
00511 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga14">ntar_get_block_type</a>(ntar_block_handle* block_handle, u_int32 *pblock_type);
00512 
00524 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga15">ntar_get_block_data</a>(ntar_block_handle* block_handle, <span class="keywordtype">void</span>** data);
00525 
00537 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga16">ntar_get_block_options</a>(ntar_block_handle* block_handle, <a class="code" href="struct__ntar__option.html">ntar_option</a> **options);
00538 
00580 <span class="keywordtype">int</span> <a class="code" href="group__ExportedFuncs.html#ga17">ntar_getversion</a>(<span class="keywordtype">char</span>* buffer, u_int32 *pbuffer_size);
00581 
00582 <span class="preprocessor">#ifdef __cplusplus</span>
00583 <span class="preprocessor"></span>}
00584 <span class="preprocessor">#endif</span>
00585 <span class="preprocessor"></span>
00586 
00587 <span class="preprocessor">#endif </span><span class="comment">/* __NTAR_09443049285795464587845827 */</span>
00588 
</pre></div>
<hr>
<p align="right"><font size="2">NTAR documentation. Copyright (c) 2004 - 2005 
Condor Engineering, Inc. All rights reserved.</font></p>
